# Naruhodo(なるほど)

[![Build Status](https://travis-ci.org/superkerokero/naruhodo.svg?branch=master)](https://travis-ci.org/superkerokero/naruhodo)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![PyPI version](https://badge.fury.io/py/naruhodo.svg)](https://badge.fury.io/py/naruhodo)

[English version](README.md)

Naruhodoは生の日本語テキスト・日本語テキストを含むWebページからnetworkxフォーマットの依存構造グラフ（DG）と情報構造グラフ（KG）を生成するためのPythonライブラリーです。Notebook内で直接可視化が可能で、JSONファィルに出力して外部プログラムに使わせる事も可能です。

### 依存構造グラフ（DG）

[依存構造解析](https://web.stanford.edu/~jurafsky/slp3/14.pdf)とは、 コンピュータプログラムで[依存文法](https://en.wikipedia.org/wiki/Dependency_grammar)に沿ってテキスト解析する事です。
依存構造は有向グラフで表す事ができます。

Naruhodoは依存構造解析プログラムの出力を直接読み込んでDGを生成します。 

この図は下記のテキストで生成されたDGです。

```
"一郎は二郎が描いた絵を三郎に贈った。"
"三郎はこの絵を持って市場に行った。"
"市場には人が一杯だ。"
```

![DG generated from texts](img/DG_example.png)

この図はWebページ [Wikipedia-ja: LLVM](https://ja.wikipedia.org/wiki/LLVM) から生成されたDGです。

![DG generated from urls](img/DG_url.png)

### 情報構造グラフ（KG）

DGと違って、情報構造グラフ（KG）がキャプチャーしようとするのは実体の間の意味のある関係です。KGも外部の構造解析プログラムの出力から生成されますが、生成プロセスのロジックが違います。

KGで使えるメソッドはDGとほぼ同じです。

この図は下記のテキストで生成されたKGです。

```
"一郎は二郎が描いた絵を三郎に贈った。"
"三郎はこの絵を持って市場に行った。"
"市場には人が一杯だ。"
```

![KG generated from texts](img/KG_example.png)

この図はWebページ [Wikipedia-ja: LLVM](https://ja.wikipedia.org/wiki/LLVM) から生成されたKGです。

![KG generated from urls](img/KG_url.png)

## インストール

Naruhodo は　`pip` でインストールできます:

```bash
pip install naruhodo
```

Naruhodo は外部プログラムで形態素解析と依存構造解析を行います。故にNaruhodoをつかうためには、対応している外部プログラムをインストールする事も必要です。

Naruhodo は複数のバックエンドプログラムに対応できるように設計されていますが、今は　`mecab` + `cabocha` のみをサポートしています。

`mecab` と `cabocha` のインストールについては、この記事を参照してください：

[Amazon Linux に MeCab と CaboCha をインストール](https://qiita.com/january108/items/85c80769ea870c190eaa)

他のバックエンドプログラム（`KNP` など）へのサポートはこれから追加する予定です。

## チュートリアル

Naruhodo のチュートリアルはリポジトリの`tutorial`フォルダに　`ipynb` ファィルとして用意されています。ブラウザから直接閲覧する事も可能です。このチュートリアルには　Naruhodo の主な機能をすべて紹介しています。

[チュートリアルのノートブック](https://github.com/superkerokero/naruhodo/blob/master/tutorial/Tutorial.ipynb)

## Python-API

Python API ドキュメントはここ:

[Naruhodo Python API Reference](https://superkerokero.github.io/naruhodo).

このドキュメントは [pdoc](https://github.com/BurntSushi/pdoc)を使って自動的にソースコードから生成されたので、常に最新のデータに更新されています。

## 開発状況とコメント

Naruhodo このライブラリーはまだ開発の途中（特にKG部分）なので、時々おかしなリザルトを返す事があると予想されます。

もしあなたもこのライブラリーのアイデアに気に入って、より良き物にしてほしいと思うなら、Githubリポのプルリクエストを出してください。

以下は naruhodo の開発についてのコメント:

* ### 生成されたグラフの質向上 (0.2 ~ 0.5)
    
    As you can see from the source code, naruhodo relies mostly on rule-based system to parse given information.
    And for a subject as large and complex as a language, long-term testing and procedural improvement of the program is neccessary before it can go anywhere.

    Currently the knowledge-graph(KG) generated by naruhodo is below my expectation for large amount of input texts. Improvement will come from furthur examination on varieties of input text and corresponding refinement of parsing logic.

    As a rule-based system, it certainly has its limitations such as completely resolving coreferences. But I believe in the realm of NLP, especially in rudimentary information parsing tasks, rule-based system can be used to make practical applications. Recent advances in statitics-based techniques such as deep learning seem promising. But almost all of these techniques require large amount of labelled data, which is hard to retrieve. The rule-based approach taken here is more or less an Ab Initio way of looking at some NLP problems(which doesn't take any training data before making useful predictions). My hope is that applications like this may at least alleviate the pain of collecting large amount of labelled data by automating some of the tedious tasks. Naruhodo is my personal experiment on how far rule-based system can go in the world of NLP. It may fail to be practically useful, but I am sure it is going to be an interesting journey.

* ### さらに多くのバックエンドをサポート (0.5 ~)
    
    There aren't many Japanese parsing programs available on the internet yet. Aside of `mecab` + `cabocha`, the most usable parsing program seems to be `juman(++)` + `knp`. The output format of `knp` does contain extra useful information and can be more accurate than `cabocha` in some situations. But its output lacks a unified scheme, making it difficult to use. Another important fact is that `juman(++)` + `knp` parsing can be very time consuming compared to `mecab` + `cabocha`, which limits its use cases.

    I am looking into some fast generic libraries like `spaCy` as well. Though Japanese is not the officially supported language for the moment. 

    To summarize, though naruhodo is designed to support multiple backends, since its current focus is Japanese only, adding support for other backends is not a priority.

* ### 他の言語へのサポート(?~)
    
    Japanese is the only language naruhodo supports now. Besides my personal interest, I chosen Japanese because it has some unique characteristics that make it both challenging and rewarding. In my opnion, the difficulty regarding Japanese mostly comes from its ambiguity in the expression(for example, the subject is frequently ommited in Japanese) and large amount of word transformations(the same verb can have as many as 10+ forms).

    From a practical point of view, languages such as English and Chinese are in potentially larger demand. So I am thinking about expanding the library to these popular languages in the future, if the rule-based approach taken by naruhodo proves to be usable afterall.

* ### 統計的手法を入れる(?~)
    
    It seems that everybody is excited about machine learning these days. And I do see huge application potential in techniques like reinforcement learning and generative adversarial models. And I do have some thoughts about the applications of these techniques to some specific knowledge retrieval problems. For example, the coreference problem is obviously outside the reach of any rule-based systems. A reinforcement learning approach seems quite attractive in this case(if we have real-time feedbacks from, for example, the users).  
    
    As my understanding of machine learning techniques improves, some statistics-based approaches may be added in the future.

* ### 生成されたグラフの具体的応用(new projects)
    
    I think information of DG and KG is especially useful in the realm of automating information retrieval processes. This includes, but not limited to, 
    * automatic summarization, 
    * Q&A system, 
    * sentiment analysis,
    * knowledge database.

    As the quality of KG generated by naruhodo improves, I will try to apply it to some of these areas.

